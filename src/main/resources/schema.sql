CREATE TABLE IF NOT EXISTS MPA
(
    ID   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME CHARACTER VARYING
);

create table IF NOT EXISTS USERS
(
    ID       INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME     CHARACTER VARYING,
    LOGIN    CHARACTER VARYING not null,
    EMAIL    CHARACTER VARYING,
    BIRTHDAY DATE
);

create table IF NOT EXISTS FILM
(
    ID           INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME         CHARACTER VARYING,
    DESCRIPTION  CHARACTER VARYING,
    RELEASE_DATE DATE,
    DURATION     INTEGER,
    RATE         CHARACTER VARYING,
    MPA          INTEGER REFERENCES MPA (ID)
);

CREATE TABLE IF NOT EXISTS GENRE
(
    ID   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY UNIQUE,
    NAME CHARACTER VARYING UNIQUE
);

CREATE TABLE IF NOT EXISTS FILM_GENRE
(
    FILM_ID  INTEGER NOT NULL REFERENCES FILM (ID),
    GENRE_ID INTEGER NOT NULL REFERENCES GENRE (ID)
);

CREATE TABLE IF NOT EXISTS LIKES
(
    FILM_ID INTEGER NOT NULL REFERENCES FILM (ID),
    USER_ID INTEGER NOT NULL REFERENCES USERS (ID)
);

CREATE TABLE IF NOT EXISTS FRIENDSHIP
(
    USER_ID   INTEGER NOT NULL REFERENCES USERS (ID),
    FRIEND_ID INTEGER NOT NULL REFERENCES USERS (ID)
);

INSERT INTO MPA (NAME)
VALUES ('G'),
       ('PG'),
       ('PG-13'),
       ('R'),
       ('NC-17');

INSERT INTO GENRE (NAME)
VALUES ('Комедия'),
       ('Драма'),
       ('Мультфильм'),
       ('Триллер'),
       ('Документальный'),
       ('Боевик');

INSERT INTO USERS (NAME, LOGIN, EMAIL, BIRTHDAY)
VALUES ('user1', 'login1', 'user@yandex.ru', '2000-12-12');

INSERT INTO USERS(NAME, LOGIN, EMAIL, BIRTHDAY)
VALUES ('user2', 'login2', 'user@yandex.ru', '2000-12-12');

INSERT INTO USERS(NAME, LOGIN, EMAIL, BIRTHDAY)
VALUES ('user3', 'login3', 'user@yandex.ru', '2000-12-12');

INSERT INTO FRIENDSHIP(USER_ID, FRIEND_ID)
VALUES ('1', '2');

INSERT INTO FRIENDSHIP(USER_ID, FRIEND_ID)
VALUES ('3', '2');

INSERT INTO FILM(NAME, DESCRIPTION, RELEASE_DATE, DURATION, RATE, MPA)
VALUES ('film1', 'descr1', '2020-10-10', '120', '1', '1');

INSERT INTO FILM(NAME, DESCRIPTION, RELEASE_DATE, DURATION, RATE, MPA)
VALUES ('film2', 'descr2', '2020-10-10', '120', '2', '1');

INSERT INTO LIKES (FILM_ID, USER_ID)
VALUES ('1', '1');